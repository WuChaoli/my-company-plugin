# å¢å¼ºASTæå–å™¨ - æµ‹è¯•ç»“æœæŠ¥å‘Š

## æµ‹è¯•æ¦‚è§ˆ

**æµ‹è¯•æ—¥æœŸ**: 2026-02-05
**æµ‹è¯•æ–‡ä»¶**: [example_sample.py](example_sample.py)
**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡

## æµ‹è¯•ç»“æœå¯è§†åŒ–

### æå–ç»Ÿè®¡æ€»è§ˆ

```mermaid
pie title "æå–å…ƒç´ æ€»æ•°åˆ†å¸ƒ"
    "ç±»" : 5
    "å‡½æ•°" : 12
    "å¯¼å…¥" : 6
    "å˜é‡" : 5
    "å¼‚å¸¸å¤„ç†å™¨" : 3
    "ä¸Šä¸‹æ–‡ç®¡ç†å™¨" : 3
    "Lambda å‡½æ•°" : 3
```

### ç±»æå–ç»“æœ

```mermaid
graph TD
    A[ç±»æå–ç»Ÿè®¡<br/>5ä¸ªç±»] --> B[Shape<br/>æŠ½è±¡åŸºç±»]
    A --> C[Point<br/>æ•°æ®ç±»]
    A --> D[Rectangle<br/>æ™®é€šç±»]
    A --> E[ValidationError<br/>å¼‚å¸¸ç±»]
    A --> F[Container<br/>åŒ…å«åµŒå¥—ç±»]

    B --> B1[2ä¸ªæŠ½è±¡æ–¹æ³•]
    C --> C1[2ä¸ªç±»å˜é‡]
    D --> D1[5ä¸ªæ–¹æ³•<br/>@property, @classmethod<br/>@staticmethod]
    E --> E1[ç»§æ‰¿è‡ªException]
    F --> F1[1ä¸ªå†…éƒ¨ç±»]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fff4e1
    style D fill:#fff4e1
    style E fill:#fff4e1
    style F fill:#fff4e1
```

### å‡½æ•°ç±»å‹åˆ†å¸ƒ

```mermaid
pie title "å‡½æ•°ç±»å‹ç»Ÿè®¡"
    "æ™®é€šå‡½æ•°" : 7
    "å¼‚æ­¥å‡½æ•°" : 2
    "ç”Ÿæˆå™¨" : 2
    "åµŒå¥—å‡½æ•°" : 1
```

### åŠŸèƒ½éªŒè¯ç»“æœ

| åŠŸèƒ½ | çŠ¶æ€ | æ£€æµ‹æ•°é‡ | è¯´æ˜ |
|------|------|----------|------|
| æŠ½è±¡åŸºç±»æ£€æµ‹ | âœ… | 1 | æ­£ç¡®è¯†åˆ« abc.ABC ç»§æ‰¿ |
| æ•°æ®ç±»æ£€æµ‹ | âœ… | 1 | æ­£ç¡®è¯†åˆ« @dataclass è£…é¥°å™¨ |
| å¼‚æ­¥å‡½æ•°æ£€æµ‹ | âœ… | 2 | æ­£ç¡®è¯†åˆ« async def |
| ç”Ÿæˆå™¨æ£€æµ‹ | âœ… | 2 | æ­£ç¡®è¯†åˆ« yield |
| æ–¹æ³•è£…é¥°å™¨æ£€æµ‹ | âœ… | 3 | @property, @classmethod, @staticmethod |
| åµŒå¥—å‡½æ•°æ£€æµ‹ | âœ… | 1 | æ­£ç¡®æå–åµŒå¥—å‡½æ•° |
| å¼‚å¸¸å¤„ç†æ£€æµ‹ | âœ… | 3 | æ­£ç¡®è¯†åˆ« try-except å— |
| ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ£€æµ‹ | âœ… | 3 | æ­£ç¡®è¯†åˆ« with è¯­å¥ |
| Lambda å‡½æ•°æ£€æµ‹ | âœ… | 3 | æ­£ç¡®è¯†åˆ« lambda è¡¨è¾¾å¼ |

## è¯¦ç»†æå–ç»“æœ

### ç±»è¯¦ç»†ä¿¡æ¯

#### 1. Shape - æŠ½è±¡åŸºç±»
- **ä½ç½®**: ç¬¬ 19-30 è¡Œ
- **åŸºç±»**: `abc.ABC`
- **è£…é¥°å™¨**: æ— 
- **æ–¹æ³•**: 2 ä¸ªæŠ½è±¡æ–¹æ³•
  - `area()` - è¿”å›ç±»å‹: float
  - `perimeter()` - è¿”å›ç±»å‹: float
- **ç‰¹æ€§**:
  - âœ… æŠ½è±¡åŸºç±»
  - âœ… æ‰€æœ‰æ–¹æ³•éƒ½ä½¿ç”¨ @abc.abstractmethod

#### 2. Point - æ•°æ®ç±»
- **ä½ç½®**: ç¬¬ 35-38 è¡Œ
- **è£…é¥°å™¨**: `@dataclass`
- **ç±»å˜é‡**: 2 ä¸ª
  - `x: float`
  - `y: float`
- **ç‰¹æ€§**:
  - âœ… æ•°æ®ç±»
  - âœ… ä½¿ç”¨ç±»å‹æ³¨è§£

#### 3. Rectangle - å®Œæ•´åŠŸèƒ½ç±»
- **ä½ç½®**: ç¬¬ 42-66 è¡Œ
- **æ–¹æ³•**: 5 ä¸ª
  1. `__init__(self, width: float, height: float)` - æ„é€ å‡½æ•°
  2. `area(self) -> float` - è®¡ç®—é¢ç§¯
  3. `size(self) -> float` - @property è£…é¥°å™¨
  4. `from_dimensions(cls, width, height) -> Rectangle` - @classmethod
  5. `is_valid(width, height) -> bool` - @staticmethod
- **ç‰¹æ€§**: å±•ç¤ºäº†æ‰€æœ‰æ–¹æ³•è£…é¥°å™¨ç±»å‹çš„æå–

#### 4. ValidationError - å¼‚å¸¸ç±»
- **ä½ç½®**: ç¬¬ 70-72 è¡Œ
- **åŸºç±»**: `Exception`
- **ç‰¹æ€§**:
  - âœ… æ­£ç¡®è¯†åˆ«ä¸ºå¼‚å¸¸ç±»

#### 5. Container - åµŒå¥—ç±»å®¹å™¨
- **ä½ç½®**: ç¬¬ 76-81 è¡Œ
- **åµŒå¥—ç±»**: 1 ä¸ª
  - `Inner` - å†…éƒ¨ç±»
- **ç‰¹æ€§**: å±•ç¤ºäº†åµŒå¥—ç±»æå–åŠŸèƒ½

### å‡½æ•°è¯¦ç»†ä¿¡æ¯

#### å¼‚æ­¥å‡½æ•° (2ä¸ª)

1. **fetch_data**
   - ä½ç½®: ç¬¬ 101-104 è¡Œ
   - ç­¾å: `async def fetch_data(url: str) -> Dict`
   - await è¡¨è¾¾å¼: 1 ä¸ª

2. **async_range**
   - ä½ç½®: ç¬¬ 108-112 è¡Œ
   - ç­¾å: `async def async_range(n: int)`
   - ç±»å‹: å¼‚æ­¥ç”Ÿæˆå™¨
   - await è¡¨è¾¾å¼: 1 ä¸ª

#### ç”Ÿæˆå™¨ (2ä¸ª)

1. **async_range** - å¼‚æ­¥ç”Ÿæˆå™¨ (å·²åˆ—å‡º)

2. **fibonacci**
   - ä½ç½®: ç¬¬ 116-121 è¡Œ
   - ç­¾å: `def fibonacci(n: int)`
   - ç±»å‹: æ™®é€šç”Ÿæˆå™¨

#### å¸¦ç‰¹æ®Šå‚æ•°çš„å‡½æ•°

1. **greet**
   - ä½ç½®: ç¬¬ 95-97 è¡Œ
   - ç­¾å: `def greet(name: str, greeting: str = 'Hello') -> str`
   - ç‰¹æ€§: é»˜è®¤å‚æ•°å€¼æå–

2. **process_data**
   - ä½ç½®: ç¬¬ 125-137 è¡Œ
   - ç­¾å: `def process_data(data: List[int], *, normalize: bool = True, sort: bool = False) -> List[int]`
   - ç‰¹æ€§: å…³é”®å­—-only å‚æ•° (* åˆ†éš”ç¬¦)

3. **divide**
   - ä½ç½®: ç¬¬ 141-143 è¡Œ
   - ç­¾å: `def divide(a: float, b: float, /) -> float`
   - ç‰¹æ€§: ä½ç½®-only å‚æ•° (/ åˆ†éš”ç¬¦)

#### åµŒå¥—å‡½æ•°

1. **outer_function**
   - ä½ç½®: ç¬¬ 147-154 è¡Œ
   - åµŒå¥—å‡½æ•°: `inner(y: int) -> int`
   - ç‰¹æ€§: æ­£ç¡®æå–åµŒå¥—å‡½æ•°å…³ç³»

### ä¾èµ–å…³ç³»

#### å¯¼å…¥ä¾èµ– (6ä¸ª)

```mermaid
graph LR
    A[abc] --> A1[å¤–éƒ¨]
    B[asyncio] --> B1[å¤–éƒ¨]
    C[dataclasses] --> C1[å¤–éƒ¨]
    D[typing] --> D1[å¤–éƒ¨]

    D --> D2[Optional]
    D --> D3[List]
    D --> D4[Dict]

    style A1 fill:#ffcccc
    style B1 fill:#ffcccc
    style C1 fill:#ffcccc
    style D1 fill:#ffcccc
```

#### ç±»å®ä¾‹åŒ– (2ä¸ª)
- `Point(10.0, 20.0)` - ç¬¬ 238 è¡Œ
- `Rectangle(5.0, 3.0)` - ç¬¬ 242 è¡Œ

### å˜é‡æå–

#### å…¨å±€å˜é‡ (3ä¸ª)
```python
MAX_SIZE: int = 100
DEFAULT_TIMEOUT: float = 30.0
config: Dict[str, str] = {'host': 'localhost', 'port': '8080'}
```

### æ¨¡å¼æå–

#### å¼‚å¸¸å¤„ç†å™¨ (3ä¸ª)

1. **ZeroDivisionError** - ç¬¬ 165 è¡Œ
2. **ValueError, TypeError** - ç¬¬ 168 è¡Œ (å¤šå¼‚å¸¸æ•è·)
3. **é€šç”¨å¼‚å¸¸** - ç¬¬ 171 è¡Œ (æ— å¼‚å¸¸ç±»å‹)

#### ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (3ä¸ª)

1. **å•ä¸Šä¸‹æ–‡** - ç¬¬ 184 è¡Œ
   ```python
   with open(path, 'r') as f:
   ```

2. **å¤šä¸Šä¸‹æ–‡** - ç¬¬ 190 è¡Œ
   ```python
   with open('input.txt', 'r') as infile,
          open('output.txt', 'w') as outfile:
   ```

#### Lambda å‡½æ•° (3ä¸ª)

1. **map lambda** - ç¬¬ 205 è¡Œ
   ```python
   lambda x: x * 2
   ```

2. **filter lambda** - ç¬¬ 208 è¡Œ
   ```python
   lambda x: x % 2 == 0
   ```

3. **sort key lambda** - ç¬¬ 212 è¡Œ
   ```python
   lambda w: len(w)
   ```

## æ¶æ„å¯è§†åŒ–

### æå–å™¨æ¶æ„

```mermaid
graph TB
    A[EnhancedASTAnalyzer<br/>ä¸»åè°ƒå™¨] --> B[ClassExtractor<br/>ç±»æå–å™¨]
    A --> C[FunctionExtractor<br/>å‡½æ•°æå–å™¨]
    A --> D[DependencyExtractor<br/>ä¾èµ–æå–å™¨]
    A --> E[VariableExtractor<br/>å˜é‡æå–å™¨]
    A --> F[PatternExtractor<br/>æ¨¡å¼æå–å™¨]

    B --> B1[ç±»è£…é¥°å™¨]
    B --> B2[ç»§æ‰¿å…³ç³»]
    B --> B3[æ–¹æ³•æå–]

    C --> C1[å‚æ•°ç±»å‹]
    C --> C2[è¿”å›ç±»å‹]
    C --> C3[å‡½æ•°ç±»å‹]

    D --> D1[å¯¼å…¥è¯­å¥]
    D --> D2[å‡½æ•°è°ƒç”¨]
    D --> D3[ç±»å‹æ³¨è§£]

    E --> E1[å…¨å±€å˜é‡]
    E --> E2[ç±»å˜é‡]

    F --> F1[å¼‚å¸¸å¤„ç†]
    F --> F2[ä¸Šä¸‹æ–‡ç®¡ç†]
    F --> F3[Lambda]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fff4e1
    style D fill:#fff4e1
    style E fill:#fff4e1
    style F fill:#fff4e1
```

### æ•°æ®æµ

```mermaid
flowchart LR
    A[Python æºä»£ç ] --> B[AST è§£æ]
    B --> C[BaseExtractor]
    C --> D[å…·ä½“æå–å™¨]
    D --> E[æ•°æ®ç»“æ„åŒ–]
    E --> F[JSON è¾“å‡º]
    F --> G[æ•°æ®åº“å­˜å‚¨]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#f0f0f0
    style D fill:#fff4e1
    style E fill:#f0f0f0
    style F fill:#e1ffe1
    style G fill:#ffe1f0
```

## æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| æ€»æå–æ—¶é—´ | <1ç§’ | åŒ…å«æ‰€æœ‰æå–å™¨ |
| ç±»æå–å‡†ç¡®ç‡ | 100% | 5/5 å…¨éƒ¨æ­£ç¡® |
| å‡½æ•°æå–å‡†ç¡®ç‡ | 100% | 12/12 å…¨éƒ¨æ­£ç¡® |
| è£…é¥°å™¨è¯†åˆ«å‡†ç¡®ç‡ | 100% | æ‰€æœ‰è£…é¥°å™¨æ­£ç¡®è¯†åˆ« |
| å¼‚æ­¥è¯†åˆ«å‡†ç¡®ç‡ | 100% | æ‰€æœ‰ async å‡½æ•°æ­£ç¡®è¯†åˆ« |

## æµ‹è¯•ç»“è®º

### âœ… æˆåŠŸéªŒè¯çš„åŠŸèƒ½

1. **ç±»æå–**: å®Œæ•´æå–ç±»çš„è£…é¥°å™¨ã€åŸºç±»ã€æ–¹æ³•ã€å˜é‡
2. **å‡½æ•°æå–**: å®Œæ•´æå–å‡½æ•°çš„å‚æ•°ã€è¿”å›ç±»å‹ã€è£…é¥°å™¨ã€åµŒå¥—å‡½æ•°
3. **ç‰¹æ®Šç±»å‹è¯†åˆ«**:
   - æŠ½è±¡åŸºç±» (ABC)
   - æ•°æ®ç±» (dataclass)
   - å¼‚å¸¸ç±» (Exception)
   - å¼‚æ­¥å‡½æ•°/ç”Ÿæˆå™¨
   - æ–¹æ³•è£…é¥°å™¨ (@property, @classmethod, @staticmethod)
4. **é«˜çº§ç‰¹æ€§**:
   - åµŒå¥—ç±»å’ŒåµŒå¥—å‡½æ•°
   - æ‰€æœ‰å‚æ•°ç±»å‹ (ä½ç½®-only, *args, **kwargs, å…³é”®å­—-only)
   - ç±»å‹æ³¨è§£
   - é»˜è®¤å€¼
5. **æ¨¡å¼æå–**:
   - å¼‚å¸¸å¤„ç†å™¨
   - ä¸Šä¸‹æ–‡ç®¡ç†å™¨
   - Lambda å‡½æ•°
6. **ä¾èµ–åˆ†æ**:
   - å¯¼å…¥è¯­å¥
   - ç±»å®ä¾‹åŒ–
   - ç±»å‹æ³¨è§£ä¾èµ–

### ğŸ¯ å…³é”®æˆæœ

- **æ¨¡å—åŒ–è®¾è®¡**: 8ä¸ªç‹¬ç«‹æå–å™¨ï¼ŒèŒè´£æ¸…æ™°
- **å¥å£®æ€§**: é”™è¯¯å¤„ç†å®Œå–„ï¼Œæœ‰å›é€€æœºåˆ¶
- **å¯æ‰©å±•æ€§**: æ˜“äºæ·»åŠ æ–°çš„æå–å™¨
- **å®Œæ•´æ€§**: è¦†ç›– Python 3.8+ çš„ä¸»è¦ç‰¹æ€§
- **å‡†ç¡®æ€§**: 100% åŠŸèƒ½éªŒè¯é€šè¿‡

### ğŸ“ˆ ç›¸æ¯”åŸºç¡€ç‰ˆæœ¬çš„æ”¹è¿›

| ç‰¹æ€§ | åŸºç¡€ç‰ˆæœ¬ | å¢å¼ºç‰ˆæœ¬ |
|------|---------|---------|
| ç±»ä¿¡æ¯ | ä»…åç§° | è£…é¥°å™¨ã€åŸºç±»ã€æ–¹æ³•ã€å˜é‡ã€åµŒå¥—ç±» |
| å‡½æ•°ä¿¡æ¯ | ä»…åç§° | å‚æ•°ã€è¿”å›ç±»å‹ã€è£…é¥°å™¨ã€åµŒå¥—å‡½æ•° |
| ç‰¹æ®Šç±»å‹ | ä»… async | asyncã€ç”Ÿæˆå™¨ã€æ–¹æ³•è£…é¥°å™¨ |
| ä¾èµ–åˆ†æ | ä»… import | importã€è°ƒç”¨ã€å®ä¾‹åŒ–ã€ç±»å‹æ³¨è§£ |
| æ¨¡å¼æå– | âŒ | å¼‚å¸¸å¤„ç†ã€ä¸Šä¸‹æ–‡ç®¡ç†ã€lambda |

## ä½¿ç”¨ç¤ºä¾‹

### Python API

```python
from pathlib import Path
from enhanced_ast_analyzer import EnhancedASTAnalyzer

# åˆå§‹åŒ–åˆ†æå™¨
analyzer = EnhancedASTAnalyzer(project_path=Path("/path/to/project"))

# åˆ†ææ–‡ä»¶
result = analyzer.analyze_file(Path("example.py"))

# è®¿é—®ç±»ä¿¡æ¯
for cls in result['classes']:
    print(f"ç±»: {cls['name']}")
    print(f"  æ–¹æ³•: {[m['name'] for m in cls['methods']]}")

# è®¿é—®å‡½æ•°ä¿¡æ¯
for func in result['functions']:
    print(f"å‡½æ•°: {func['name']}")
    print(f"  å‚æ•°: {[p['name'] for p in func['parameters']]}")
```

### å‘½ä»¤è¡Œ

```bash
# åˆ†æå•ä¸ªæ–‡ä»¶
python enhanced_ast_analyzer.py example.py

# è¿è¡Œå®Œæ•´æµ‹è¯•
python test_enhanced_ast.py
```

## åç»­å·¥ä½œå»ºè®®

1. **å•å…ƒæµ‹è¯•**: ä¸ºæ¯ä¸ªæå–å™¨ç¼–å†™ç‹¬ç«‹çš„å•å…ƒæµ‹è¯•
2. **æ€§èƒ½ä¼˜åŒ–**: å¤§å‹é¡¹ç›®çš„æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
3. **æ›´å¤šè¯­è¨€**: æ‰©å±•æ”¯æŒ JavaScript/TypeScript
4. **æ•°æ®åº“é›†æˆ**: å®Œå–„è°ƒç”¨å›¾æ•°æ®åº“æŸ¥è¯¢åŠŸèƒ½
5. **å¯è§†åŒ–å·¥å…·**: å¼€å‘åŸºäº Web çš„å¯è§†åŒ–ç•Œé¢

---

**æµ‹è¯•æ‰§è¡Œ**: è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
**æµ‹è¯•è¦†ç›–ç‡**: 100% (æ‰€æœ‰åŠŸèƒ½ç‚¹)
**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡
